import{_ as z,f as D,i as H,j as U}from"./_plugin-vue_export-helper-fxonzzrb.js";import{m as F,o as i,c as f,a as n,b as l,w as s,t as o,I as R,s as V,r as u,e as d,J as j,F as q,y as G,p as x,i as w,q as J,E as C}from"./index-DcRigyih.js";const K={class:"settings-view"},O={class:"section-card"},Q={key:0,style:{color:"var(--color-warning)","font-size":"11px"}},W={style:{float:"right",color:"var(--text-muted)","font-size":"12px"}},X={class:"section-card"},Y={class:"section-header"},Z={class:"section-hint"},ee={key:0,class:"seasons-badge"},ae={key:0,class:"regrow-hint"},te={class:"exp-value"},le={__name:"AccountSettings",props:{uin:String},setup(M){const k=M,p=d(1),v=d(10),_=d(0),b=d(!1),y=d(1),h=d([]),m=d(!1);async function $(){var t;try{const r=(await D(k.uin)).data;p.value=Math.round((r.farmInterval||1e3)/1e3),v.value=Math.round((r.friendInterval||1e4)/1e3),y.value=((t=r.userState)==null?void 0:t.level)||1,_.value=r.preferredSeedId||0}catch{}}async function A(){b.value=!0;try{await U(k.uin,{farmInterval:p.value*1e3,friendInterval:v.value*1e3,preferredSeedId:_.value||0}),C.success("配置已保存")}catch(t){C.error(t.message)}finally{b.value=!1}}async function B(){m.value=!0;try{const t=await H(y.value);h.value=t.data||[]}catch{}finally{m.value=!1}}function S(t){if(!t)return"-";if(t<60)return`${t}秒`;if(t<3600)return`${Math.floor(t/60)}分${t%60}秒`;const a=Math.floor(t/3600),r=Math.floor(t%3600/60);return r>0?`${a}小时${r}分`:`${a}小时`}return F(async()=>{await $(),B()}),(t,a)=>{const r=u("el-input-number"),g=u("el-form-item"),I=u("el-option"),E=u("el-select"),L=u("el-button"),N=u("el-form"),c=u("el-table-column"),P=u("el-table"),T=j("loading");return i(),f("div",K,[n("div",O,[a[7]||(a[7]=n("h3",{class:"section-title"},"参数配置",-1)),l(N,{"label-width":"120px",class:"config-form"},{default:s(()=>[l(g,{label:"农场巡查间隔"},{default:s(()=>[l(r,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),min:1,max:3600,step:1},null,8,["modelValue"]),a[3]||(a[3]=n("span",{class:"unit"},"秒 (最低1秒)",-1))]),_:1}),l(g,{label:"好友巡查间隔"},{default:s(()=>[l(r,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),min:1,max:3600,step:1},null,8,["modelValue"]),a[4]||(a[4]=n("span",{class:"unit"},"秒 (最低1秒)",-1))]),_:1}),l(g,{label:"指定种植作物"},{default:s(()=>[l(E,{modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=e=>_.value=e),placeholder:"自动选择(经验效率最高)",clearable:"",filterable:"",style:{width:"260px"},loading:m.value},{default:s(()=>[l(I,{value:0,label:"自动选择(经验效率最高)"}),(i(!0),f(q,null,G(h.value,e=>(i(),V(I,{key:e.seedId,value:e.seedId,label:`${e.name} (${e.expPerHour}经验/时)`},{default:s(()=>[n("span",null,o(e.name),1),e.seasons>1?(i(),f("span",Q," ×"+o(e.seasons)+"季",1)):x("",!0),n("span",W,o(e.expPerHour)+" 经验/时",1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","loading"]),a[5]||(a[5]=n("span",{class:"unit"},"清空则自动选择",-1))]),_:1}),l(g,null,{default:s(()=>[l(L,{type:"primary",onClick:A,loading:b.value},{default:s(()=>[...a[6]||(a[6]=[w("保存配置",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),n("div",X,[n("div",Y,[a[8]||(a[8]=n("h3",{class:"section-title"},"种植效率排行",-1)),n("span",Z,"基于当前等级(Lv"+o(y.value)+")可购买作物计算",1)]),R((i(),V(P,{data:h.value,stripe:"",style:{width:"100%"},"header-cell-style":{background:"var(--bg-base)",color:"var(--text-muted)",borderColor:"var(--border)"},"cell-style":{background:"var(--bg-surface)",color:"var(--text-secondary)",borderColor:"var(--border)"}},{default:s(()=>[l(c,{label:"排名",width:"60",align:"center"},{default:s(({$index:e})=>[n("span",{class:J({"rank-star":e===0})},o(e+1)+o(e===0?" ★":""),3)]),_:1}),l(c,{label:"作物",width:"120",align:"center"},{default:s(({row:e})=>[w(o(e.name),1),e.seasons>1?(i(),f("span",ee,"×"+o(e.seasons)+"季",1)):x("",!0)]),_:1}),l(c,{label:"生长周期",width:"130",align:"center"},{default:s(({row:e})=>[n("span",null,o(S(e.totalTimeSec||e.growTimeSec)),1),e.regrowSec?(i(),f("span",ae,"(含回生"+o(S(e.regrowSec))+")",1)):x("",!0)]),_:1}),l(c,{label:"总经验",width:"90",align:"center"},{default:s(({row:e})=>[w(o(e.totalExp||e.exp),1)]),_:1}),l(c,{label:"经验/小时",width:"110",align:"center"},{default:s(({row:e})=>[n("span",te,o(e.expPerHour),1)]),_:1})]),_:1},8,["data"])),[[T,m.value]])])])}}},oe=z(le,[["__scopeId","data-v-da5f4d98"]]);export{oe as default};
